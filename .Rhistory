"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG7.csv"
)
# Step 1: Import first databse
dEstab <- read_delim("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB0.csv",
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
View(dEstab)
# Step 3: Import and Bind all database
for (i in 1:length(ad)){
dEstab <- rbind(dEstab,
read_delim(ad[i],
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
)
}
View(dEstab)
remove(dEstab)
# Step 1: Import first databse
dEstab <- read_delim("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB0.csv",
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
# Step 3: Import and Bind all database
for (i in 1:length(ad)){
dEstab <- rbind(dEstab,
read_delim(ad[i],
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
)
}
View(dEstab)
remove(dEstab)
# Step 1: Import first databse
dEstab <- read_delim("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB0.csv",
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
# Step 2: Address Vector
ad <- c("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP10.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP11.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG7.csv"
)
# Step 3: Import and Bind all database
for (i in 1:length(ad)){
dEstab <- rbind(dEstab,
read_delim(ad[i],
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
)
}
# setting the chunck configuration
knitr::opts_chunk$set(echo = FALSE,
comment = NA,
warning = FALSE,
error = FALSE,
message = FALSE,
tidy = TRUE)
# setting main root in personal drive
print(getwd())
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
dwdir = print(getwd()) # main personal project root
{
# Check if the packages that we need are installed
want = c("RCurl", "tidyverse", "readr", "zoo", "googledrive", "RCurl",
"gsheet", "stringr", "knitr", "data.table", "readxl", "qdapRegex")
have = want %in% rownames(installed.packages())
# Install the packages that we miss
if ( any(!have) ) { install.packages( want[!have] ) }
# Load the packages
junk <- lapply(want, library, character.only = T)
# Remove the objects we created
rm(have, want, junk)
} # Import packages
# setting principal roots (dw + first 3 database words + data type)
dwagriraw = paste0(dwdir, "/db/raw/agricultural")
{
# Step 1: Import first databse
dEstab <- read_delim("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB0.csv",
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
# Step 2: Address Vector
ad <- c("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP10.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP11.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG7.csv"
)
# Step 3: Import and Bind all database
for (i in 1:length(ad)){
dEstab <- rbind(dEstab,
read_delim(ad[i],
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
)
}
} # Part 1: Import Data Base
View(dEstab)
colnames(dEstab)[c(1:2,13:15)] <- c("city",
"cnae",
"simple",
"jure",
"size")
View(dEstab)
unique(dEstab$simple)
dEstab[is.na(dEstab$simple),]
{
# Step 1: Import first databse
dEstab <- read_delim("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB0.csv",
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
# Step 2: Address Vector
ad <- c("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP10.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP11.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG7.csv"
)
# Step 3: Import and Bind all database
for (i in 1:length(ad)){
dEstab <- rbind(dEstab,
read_delim(ad[i],
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
)
}
colnames(dEstab)[c(1:2,13:15)] <- c("city",
"cnae",
"simple",
"jure",
"size")
} # Part 1: Import Data Base
View(dEstab)
unique(dEstab$simple)
unique(dEstab$jure)
unique(dEstab$size)
dEstab[dEstab$size == "51 a 99",]
dEstab[dEstab$size == "101 a 99",]
{
# Step 1: Import first databse
dEstab <- read_delim("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB0.csv",
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
# Step 2: Address Vector
ad <- c("~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ADMPUB9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ASS9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/COO9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP10.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/EMP11.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ENT9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES5.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES7.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES8.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/PES9.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG0.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG1.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG2.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG3.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG4.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG6.csv",
"~/Profissional/SEPL/PowerBi 3/Banco de Dados/RAIS/ESTABELECIMENTOS/ORG7.csv"
)
# Step 3: Import and Bind all database
for (i in 1:length(ad)){
dEstab <- rbind(dEstab,
read_delim(ad[i],
delim = ";",
escape_double = FALSE,
col_types = cols(Tamanho = col_character()),
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
)
}
colnames(dEstab)[c(1:2,13:15)] <- c("city",
"cnae",
"simple",
"jure",
"size")
} # Part 1: Import Data Base
# Step 1: import city database
fCity = read_delim("C:/Users/CepaTech/Documents/Profissional/SEPL/PowerBi 3/Banco de Dados/citiy/fcity2.csv",
";", escape_double = FALSE,
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "UTF-8"),
trim_ws = TRUE)
# Step 1: import city database
fCity = read_delim("C:/Users/CepaTech/Documents/Profissional/SEPL/PowerBi 3/Banco de Dados/citiy/fcity.csv",
";", escape_double = FALSE,
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "UTF-8"),
trim_ws = TRUE)
# Step 1: import city database
fCity = read_delim("C:/Users/CepaTech/Documents/Profissional/SEPL/PowerBi 3/Banco de Dados/citiy/fcity.csv",
";", escape_double = FALSE,
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "UTF-8"),
trim_ws = TRUE)
# Step 1: import city database
fCity = read_delim("C:/Users/CepaTech/Documents/Profissional/SEPL/PowerBi 3/Banco de Dados/citiy/fcity.csv",
";", escape_double = FALSE,
locale = locale(decimal_mark = ",",
grouping_mark = ".",
encoding = "ISO-8859-1"),
trim_ws = TRUE)
